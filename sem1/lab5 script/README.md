# Лабораторная работа №5. Работа в командной строке.

## Цель работы:
- Освоить командные оболочки shell (для OS семейства Unix) и cmd (для OS семейства MS Windows):
    - изучить основные встроенные команды;
    - научиться писать файлы сценариев;
    - научиться соотносить командные оболочки для разных OS.
- Освоить командное окружение для OS семейства Unix (утилиты из пакета GNU Core Utilities), и соответствующие им утилиты для OS семейства MS Windows.

## Задачи:
- Познакомиться с консольными программными окружениями OS Windows и OS Linux.
- Получить практические навыки работы в консоли, использования консольных команд.

## Вариант:
- Мне был предоставлен вариант №37. Согласно выданному варианту моим задание было создать файлы sh и bat, которые выполняют следующее:
    - На вход пакетному файлу приходит файл (как параметр пакетного файла), содержащий некоторый список строк. Отсортировать указанный файл. Создать два файла, в первом из которых будут содержаться нечетные строки из входного файла, во втором - четные.

## Ход работы:
1. Для написания bash-скрипта, выпоняющего поставленную задачу, были применены следующие инструменты:
```bash
#!bin/bash
```
Любой bash-скрипт должен начинаться с этой команды. В этой строке после указывается путь к bash-интерпретатору (по умолчанию bin/bash, однако он может быть установлен в другом месте).
```bash
fileName=$1
```
К кажому аргументу командной строки можно обратиться при помощи конструкции "$<порядковый номер аргумента>".
```bash
while read currentString; do
	fileText[$i]=$currentString
	i=$(($i+1))
done < $fileName
```
Для обращения к переменным перед её именем также должен стоять знак "$". Данный участок кода читает строки из файла на пути fileName и записывает их в массив fileText. currentString - строка, прочитанная программой из файла в данный момент времени.
```bash
readarray -td '' sortedFile < <(printf '%s\0' "${fileText[@]}" | sort -z)
```
Данная строка сортирует строки файла по алфавиту и записывает результат в массив sortedFile. Флаг -t у функции readarray удаляет все лидирующие и лишние пробелы из каждой строки. Флаг -d устанавливает разделитель в качестве нулевого символа ('\0'). printf '%s\0' записывает в файл строки, разделенные нулевым символом. Флаг -z у функции sort сортирует строки, разделенные нулевыми символами.
```bash
for i in ${!sortedFile[@]}; do
	if [[ $(($i%2)) -eq 0 ]]; then
		echo "${sortedFile[$i]}" >> oddStrings.txt;
	else
		echo "${sortedFile[$i]}" >> evenStrings.txt;
	fi
done
```
Данный участок кода расфасовывает строки по разным файлам. Четные - в один файлик, нечетные - в другой. Оператор -eq представляет собой проверку на равенство операндов, стоящих слева и справа от него.
2. Для создание файла bat, решающего ту же задачу применялись следующие инструменты:
```batch
@echo off
```
Данная команла необходима для того, чтобы каждая операция, выполненная скриптом, не выводилась в консоль.
```batch
setlocal EnableDelayedExpansion
```
Эта строчка отвечает за корректную работу внешнего счётчика цикла. Дело в том, что по умолчанию в языке batch нельзя получить доступ к текущему значению внешней переменной-счетчика. Однако, после написания этой строчки, к текущему значению переменной можно получить доступ, окружив название переменной символами "!".
```batch
set fileName=%1
```
В отличие от bash, доступ к аргументам командной строки осуществляется при помощи символа "%".
```batch
cd . > temp.txt
```
Команда выше отвечает за создание пустого файла.
```batch
sort %fileName% /o temp.txt
```
Выполнение данной команды приводит к тому, что содержимое файла, находящееся на пути fileName сортируется и записывается в файл temp.txt. После флага /o указывается путь до файла, будет записан результат сортировки. Если флаг не указан, то результат будет выведен в стандартный ввод.
```batch
set counter=1
set currentCounterValueMod2=0
for /f %%i in (temp.txt) do (
	set /a currentCounterValueMod2=!counter!%%2

	if !currentCounterValueMod2! equ 1 (
		echo %%i >> oddStrings.txt
	) else (
		echo %%i >> evenStrings.txt
	)

	set /a counter=counter+1
)
```
Данный участок кода расфасовывает строки из файла temp.txt по двум другим файлам. Флаг /f у цикла for позволяет читать файл, указанный в качестве аргумента, построчно. equ - оператор сравнения (проверка на равенство). Команда echo записывает строку в файл. Команла set является оператором присваивания, флаг /a означает, что выполняется арифметическая операция.
```batch
del temp.txt
```
Удаляем файл temp.txt.
```batch
endlocal
```
Отменяет действие команды setlocal. Команда не является обязательной.

## Тестовые примеры
В качестве тестового примера был создан файл test.txt, в котором хранилась следующая информация:
```
grape
banana
cherry
apple
date
```
В результате выполнения обоих скриптов был получен один и тот же ответ:
```
apple
cherry
grape
```
Файл oddStrings.txt.
```
banana
date
```
Файл evenStrings.txt.

## Вывод
В ходе выполения данной лабораторной работы я:
- Освоил командные оболочки shell (для OS семейства Unix) и cmd (для OS семейства MS Windows).
- Освоил командное окружение для OS семейства Unix (утилиты из пакета GNU Core Utilities), и соответствующие им утилиты для OS семейства MS Windows.
- Написал bash- и batch-скрипты, выполняющие данное мне задание.