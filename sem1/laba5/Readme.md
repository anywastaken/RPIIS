# Лабораторная работа 5

## Цель работы:

* Освоить командные оболочки shell (для OS семейства Unix) и cmd (для OS семейства MS Windows):

1) изучить основные встроенные команды,
2) научиться писать файлы сценариев,
3) научиться соотносить командные оболочки для разных OS.

* Освоить командное окружение для OS семейства Unix(утилиты из пакета GNU Core Utilities), и соответствующие им утилиты для OS семейства MS Windows.


 ## Задачи:
* Познакомиться с консольными программными окружениями OS Windows и OS Linux.
* Получить практические навыки работы в консоли, использования консольных команд.

## Задание:

**Вариант 33**. Создать файл sh и bat, который выполняет следующее:

На вход файлу подается путь к каталогу(как параметр пакетного файла). Если такой папки нет, то писать “Данной папки нет” и завершить выполнение программы. Если такая папка есть, то в ней и ее подкаталогах считываем размеры файлов в формате “имя_файла размер_файла” и записываем их в новый файл, который является вторым параметром пакетного файла. Отсортировать содержимое в порядке уменьшения размера файлов.

## Ход работы:
Код для Windows:

```
@echo off
chcp 65001

if "%~1"=="" (
echo Не указан путь к каталогу
exit /b
)

if not exist "%~1" (
echo Данной папки нет
exit /b 
)

if "%~2"=="" (
echo Не указан путь к новому файлу для записи
exit /b
)

setlocal enabledelayedexpansion
set "direct=%~1"
set "output=%~2"
set "temp_file=temp_file.txt"
set "sort_temp_file=sort_temp_file.txt"

for /r "%direct%" %%f in (*) do (
    set "size=%%~zf"
    set "name=%%~nxf"
    echo !size! !name! >> "%temp_file%"
)
sort /r "%temp_file%" > "%sort_temp_file%"

for /f "tokens=1,2 delims= " %%a in (%sort_temp_file%) do (
    echo %%b %%a 
) >> "%output%"

del "%temp_file%"
del "%sort_temp_file%"

echo Результаты сохранены в "%output%"
endlocal
exit /b
```
Код для Linux:
```
#!\bin\bash

if [ -z "$1" ]
then
echo "Не указан путь к каталогу"
exit
fi

if [ ! -d "$1" ]
then
echo "Данной папки нет"
exit
fi

if [ -z "$2" ]
then
echo "Не указан путь к новому файлу для записи"
exit
fi

direct="$1"
output_file="$2"

temp_file=$(mktemp)

find "$direct" -type f -exec stat --format="%n %s" {} \; | while read name size
do
base_name=$(basename "$name")
echo "$base_name $size"
done > "$temp_file"

if [ ! -s "$temp_file" ]
then
echo "Каталог пустой"
exit
fi

sort -nr -k2 "$temp_file" > "$output_file"

rm "$temp_file"

exit
```

## Основные команды:

* echo off - для отключения вывода выполняемых команд;
* echo - для вывода текста на экран или в файл;
* exit /b - для выхода из текущего подскрипта;
* set - объявление переменных;
* :: - для комментариев.

Для Linux
* #!/bin/bash - указание интерпретатора (какой интерпретатор будет использоваться для выполнения файла и его путь);
* echo - для вывода текста на экран или в файл;
* exit - для выхода из подскрипта;
* find - для поиска файлов и каталогов;
* sort -nr -k2 - для сортировки **числовых** значений **по** **убыванию** по **второму** элементу.

## Вывод 

В результате лабораторной работы были созданы bat и sh файлы. Были освоены командные оболочки shell и cmd. Все поставленные цели были достигнуты, а задачи выполнены.

