# Лабораторная работа 5
 
### Цель: 
 
Освоить командные оболочки cmd и shell:
+ изучить основные встроенные команды,
+ научиться писать файлы сценариев,
+ научиться соотносить командные оболочки для разных OS.
+ Освоить командное окружение для OS семейства Unix(утилиты из пакета GNU Core Utilities), и соответствующие им утилиты для OS семейства MS Windows.
### Условия задания
Вариант 33: Создать файл sh и bat, который выполняет следующее: 
На вход файлу подается путь к каталогу(как параметр пакетного файла). Если такой папки нет, то писать “Данной папки нет” и завершить выполнение программы. Если такая папка есть, то в ней и ее подкаталогах считываем размеры файлов в формате “имя_файла размер_файла” и записываем их в новый файл, который является вторым параметром пакетного файла. Отсортировать содержимое в порядке уменьшения размера файлов.
## Batch файл
- ### Код программы
```batch
@echo off
chcp 65001 
setlocal enabledelayedexpansion

set /p "directory=Введите путь к директории: "
set /p "file=Введите путь к выходному файлу: "

if not exist "!directory!" (
    echo Директория не найдена.
    exit /b
)
cd %directory%
:rec
for %%f in (*) do (
    echo %%f %%~zf>> %file%
)

for /D %%d in (*) do (
    cd %%d
    call :rec
    cd ..
)

powershell -command "Get-Content %file% | Sort-Object { [int]($_.Split(' ')[-1]) } -Descending | Set-Content %file%

echo Результаты записаны в: %file%

endlocal
```
### Пример
![](cmd.png.png)

### Пояснение кода
Отключает вывод команд в командной строке, что делает вывод более чистым и удобным для пользователя.
```
@echo off
```
Устанавливает кодировку UTF-8, чтобы корректно отображать кириллические символы.
```
chcp 65001
```
Запрашивает у пользователя путь к директории и выходному файлу.
```
set /p "directory=Введите путь к директории: "
set /p "file=Введите путь к выходному файлу: "
```
Проверяет существование указанной директории
```
if not exist "!directory!" (
    echo Директория не найдена.
    exit /b
)
```
Создает функцию rec, которая записывает в выходной файл имя и размер каждого файла и которую можно вызвать с помощью call
```
:rec
for %%f in (*) do (
    echo %%f %%~zf>> %file%
)
```
Цикл который проходит по данной директории и всем ее подкаталогам.

```
for /D %%d in (*) do (
    cd %%d
    call :rec
    cd ..
)
```
Ввиду невозвожности работы команды sort с численными значениями, была задействована сортировка с помощью powershell.
```
powershell -command "Get-Content %file% | Sort-Object { [int]($_.Split(' ')[-1]) } -Descending | Set-Content %file%
```
Считывает исходый файл.
```
Get-Content %file%
```
Делит каждую строку на две части и преобразует вторую часть строки в число, затем сортирует.
```
Sort-Object { [int]($_.Split(' ')[-1]) } -Descending(от большего к меньшему)
```
Записывает в файл отсортированные строки.
```
Set-Content %file%
```

### Выводы: 
 В ходе выполнения лабораторной работы обрел практические и теоретические навыки работы с консольными программами и командами в таких ОС как Windows и Linux. 
